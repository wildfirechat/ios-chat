# 消息备份恢复功能 UI 设计文档

## 文档版本

| 版本 | 日期 | 作者 | 说明 |
|------|------|------|------|
| 1.0 | 2025-01-09 | Claude | 初始版本 |

---

## 1. 导航路径

### 1.1 主入口

```
我的
  └─ 设置
       └─ 备份与恢复  [新增]
            ├─ 备份
            └─ 恢复
```

### 1.2 导航流程

```
APP 主界面
    ↓
点击"我的"标签
    ↓
点击"设置"按钮
    ↓
点击"备份与恢复"菜单项 ← 新增
    ↓
进入"备份与恢复"主界面
    ├─ 点击"备份"按钮 → 备份界面
    └─ 点击"恢复"按钮 → 恢复界面
```

---

## 2. 主界面设计

### 2.1 备份与恢复主页

#### 界面布局

```
┌─────────────────────────────────────┐
│  < 备份与恢复                        │  导航栏
├─────────────────────────────────────┤
│                                     │
│  ┌───────────────────────────────┐  │
│  │        备份聊天记录            │  │  主图标/插图
│  │                               │  │
│  │   备份可以保存您的聊天消息，   │  │  说明文字
│  │   防止数据丢失                │  │
│  └───────────────────────────────┘  │
│                                     │
│  ┌───────────────────────────────┐  │
│  │                               │  │
│  │   📱 创建备份                 │  │  备份按钮
│  │                               │  │
│  └───────────────────────────────┘  │
│                                     │
│  ┌───────────────────────────────┐  │
│  │                               │  │
│  │   📂 从备份恢复               │  │  恢复按钮
│  │                               │  │
│  └───────────────────────────────┘  │
│                                     │
│  ┌───────────────────────────────┐  │
│  │  💡 提示：                     │  │
│  │  • 备份文件可以导出到电脑       │  │  提示信息
│  │  • 建议定期备份以防数据丢失     │  │
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

#### 功能说明

- **创建备份**：进入备份界面，选择会话进行备份
- **从备份恢复**：进入恢复界面，查看和选择备份文件进行恢复
- **提示信息**：显示备份相关的建议和注意事项

---

## 3. 备份界面设计

### 3.1 会话选择界面

#### 界面布局

```
┌─────────────────────────────────────┐
│  < 备份聊天记录                      │  导航栏
├─────────────────────────────────────┤
│  全选 [✓]                          │  全选按钮
├─────────────────────────────────────┤
│  ┌───────────────────────────────┐  │
│  │  [✓] 张三                     │  │  会话项
│  │       最后消息：你好吗...      │  │  (单聊)
│  └───────────────────────────────┘  │
│                                     │
│  ┌───────────────────────────────┐  │
│  │  [✓] 产品讨论群               │  │
│  │       李四: 需求文档已更新...  │  │  (群聊)
│  └───────────────────────────────┘  │
│                                     │
│  ┌───────────────────────────────┐  │
│  │  [  ] 技术交流群               │  │
│  │       王五: 这个bug怎么修复... │  │
│  └───────────────────────────────┘  │
│                                     │
│  ... 更多会话                       │
│                                     │
├─────────────────────────────────────┤
│  已选择：3 个会话                    │  统计信息
│                                     │
│  ┌───────────────────────────────┐  │
│  │        下一步                  │  │  下一步按钮
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

#### 功能说明

**顶部操作**：
- 全选按钮：一键选择/取消所有会话
- 统计信息：显示已选择的会话数量

**会话列表**：
- 每个会话显示：
  - 复选框：选择/取消选择
  - 会话名称：对方昵称或群名称
  - 最后消息：预览最后一条消息内容
  - 头像：会话头像
  - 未读数（可选）：是否显示未读数
- 支持滚动浏览所有会话
- 支持搜索/过滤（可选功能）

**底部操作**：
- 已选择统计：实时更新选择的会话数量
- 下一步按钮：进入备份选项设置

### 3.2 备份选项界面

#### 界面布局

```
┌─────────────────────────────────────┐
│  < 备份选项                          │  导航栏
├─────────────────────────────────────┤
│  备份内容                            │
│                                     │
│  ○ 仅备份消息                        │  选项
│     • 文件较小                      │
│     • 备份速度快                    │
│                                     │
│  ● 备份消息和媒体文件                │  选项（默认）
│     • 完整备份                      │
│     • 包含图片、视频、文件等        │
│                                     │
├─────────────────────────────────────┤
│  加密选项                            │
│                                     │
│  ○ 不加密                            │  选项
│     • 任何人都可以查看              │
│                                     │
│  ● 使用密码保护                      │  选项（推荐）
│     • 只有知道密码才能查看          │
│     • [输入密码...]                 │  密码输入框
│     • [密码提示...（可选）]          │  密码提示
│                                     │
├─────────────────────────────────────┤
│  备份名称                            │
│  ┌───────────────────────────────┐  │
│  │ 聊天备份_2025-01-09             │  │  文本输入框
│  └───────────────────────────────┘  │
│                                     │
│  预计信息                            │
│  • 会话数量：3 个                    │  预估信息
│  • 消息数量：约 1,234 条             │
│  • 预计大小：约 5.2 MB               │
│                                     │
│  ┌───────────────────────────────┐  │
│  │        开始备份                │  │  开始备份按钮
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

#### 功能说明

**备份内容选择**：
- 仅备份消息：不包含媒体文件，文件小，速度快
- 备份消息和媒体文件：完整备份，包含所有媒体

**加密选项**：
- 不加密：备份文件可以自由查看
- 使用密码保护：需要密码才能查看和恢复备份
  - 密码输入框
  - 密码提示（可选，帮助记忆密码）

**备份信息**：
- 备份名称：自动生成，可修改
- 预计信息：实时显示会话数、消息数、预计大小

**开始备份**：
- 点击后开始创建备份
- 显示备份进度

### 3.3 备份进度界面

#### 界面布局

```
┌─────────────────────────────────────┐
│  < 正在备份                          │  导航栏
├─────────────────────────────────────┤
│                                     │
│         [备份图标动画]              │  动画图标
│                                     │
│  正在备份聊天记录...                │  状态文字
│                                     │
│  ┌───────────────────────────────┐  │
│  │ ████████░░░░░░░░░░░░░░░░░░  │  │  进度条
│  │ 45%                            │  │
│  └───────────────────────────────┘  │
│                                     │
│  已备份：567 / 1,234 条消息          │  详细信息
│  当前会话：产品讨论群                │
│  已用时间：00:23                     │
│  剩余时间：约 00:28                  │
│                                     │
│  ┌───────────────────────────────┐  │
│  │        取消备份                │  │  取消按钮
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

#### 功能说明

**进度显示**：
- 进度条：显示备份进度百分比
- 统计信息：已备份消息数/总消息数
- 当前状态：正在备份的会话名称
- 时间估算：已用时间、剩余时间

**操作**：
- 取消按钮：取消当前备份操作
- 取消后确认：弹出确认对话框

### 3.4 备份完成界面

#### 界面布局

```
┌─────────────────────────────────────┐
│  < 备份完成                          │  导航栏
├─────────────────────────────────────┤
│                                     │
│        [成功图标 ✓]                 │  成功图标
│                                     │
│  备份已成功创建！                    │  成功提示
│                                     │
│  备份信息：                          │
│  • 备份名称：聊天备份_2025-01-09     │  备份信息
│  • 会话数量：3 个                    │
│  • 消息数量：1,234 条                │
│  • 文件大小：5.2 MB                  │
│  • 备份时间：2025-01-09 14:30        │
│  • 加密方式：密码保护                │
│                                     │
│  ┌───────────────────────────────┐  │
│  │        分享                    │  │  分享按钮
│  └───────────────────────────────┘  │  导出备份文件
│                                     │
│  ┌───────────────────────────────┐  │
│  │        完成                    │  │  完成按钮
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

#### 功能说明

**备份信息**：
- 显示备份的详细信息
- 包含会话数、消息数、文件大小、时间等

**操作选项**：
- 分享：导出备份文件到其他应用（微信、邮件、云盘等）
- 完成：返回主界面

---

## 4. 恢复界面设计

### 4.1 备份列表界面

#### 界面布局

```
┌─────────────────────────────────────┐
│  < 从备份恢复                        │  导航栏
├─────────────────────────────────────┤
│  ┌───────────────────────────────┐  │
│  │  [+ 导入备份文件]              │  │  导入按钮
│  └───────────────────────────────┘  │
│                                     │
│  本地备份                            │  分组标题
│                                     │
│  ┌───────────────────────────────┐  │
│  │ 🔒 聊天备份_2025-01-09          │  │  备份项（加密）
│  │    • 3 个会话 • 1,234 条消息    │  │
│  │    • 5.2 MB • 2025-01-09 14:30  │  │
│  │    [删除] [详情] [恢复]        │  │
│  └───────────────────────────────┘  │
│                                     │
│  ┌───────────────────────────────┐  │
│  │ 聊天备份_2025-01-08              │  │  备份项（未加密）
│  │    • 5 个会话 • 2,456 条消息    │  │
│  │    • 3.8 MB • 2025-01-08 10:15  │  │
│  │    [删除] [详情] [恢复]        │  │
│  └───────────────────────────────┘  │
│                                     │
│  ... 更多备份                        │
│                                     │
│  云端备份（可选功能）                │  分组标题
│                                     │
│  ┌───────────────────────────────┐  │
│  │ ☁️ iCloud 备份                 │  │  云端备份项
│  │    • 8 个会话 • 5,678 条消息    │  │
│  │    • 12.5 MB • 2025-01-07 09:20 │  │
│  │    [下载] [详情] [恢复]        │  │
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

#### 功能说明

**导入按钮**：
- 点击后打开文件选择器
- 支持选择 .json 备份文件
- 导入后自动扫描备份信息

**备份列表**：
- 显示所有可用的备份文件
- 每个备份项显示：
  - 加密图标（🔒）：表示该备份已加密
  - 备份名称
  - 会话数量
  - 消息数量
  - 文件大小
  - 备份时间
  - 操作按钮：删除、详情、恢复

**分组显示**：
- 本地备份：存储在本地的备份文件
- 云端备份（可选）：iCloud 或其他云存储的备份

**备份排序**：
- 按时间倒序排列（最新的在前）

### 4.2 备份详情界面

#### 界面布局

```
┌─────────────────────────────────────┐
│  < 备份详情                          │  导航栏
├─────────────────────────────────────┤
│  聊天备份_2025-01-09                 │  备份名称
│                                     │
│  基本信息                            │
│  • 备份时间：2025-01-09 14:30:05     │
│  • 备份模式：消息 + 媒体文件         │
│  • 加密方式：密码保护                │
│  • 备份版本：1.0                     │
│                                     │
│  内容统计                            │
│  • 会话数量：3 个                    │
│  • 消息数量：1,234 条                │
│  • 媒体文件：56 个                   │
│  • 总大小：5.2 MB                    │
│                                     │
│  包含的会话                          │
│  ┌───────────────────────────────┐  │
│  │ 张三                           │  │  会话列表
│  │    456 条消息 • 12 个媒体文件   │  │
│  └───────────────────────────────┘  │
│  ┌───────────────────────────────┐  │
│  │ 产品讨论群                     │  │
│  │    678 条消息 • 30 个媒体文件   │  │
│  └───────────────────────────────┘  │
│  ┌───────────────────────────────┐  │
│  │ 技术交流群                     │  │
│  │    100 条消息 • 14 个媒体文件   │  │
│  └───────────────────────────────┘  │
│                                     │
│  ┌───────────────────────────────┐  │
│  │        恢复此备份              │  │  恢复按钮
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

#### 功能说明

**基本信息**：
- 备份名称
- 备份时间
- 备份模式（仅消息/消息+媒体）
- 加密方式
- 备份版本

**内容统计**：
- 会话数量
- 消息数量
- 媒体文件数量
- 总大小

**包含的会话**：
- 列出备份中包含的所有会话
- 每个会话显示：
  - 会话名称
  - 消息数量
  - 媒体文件数量

**操作**：
- 恢复按钮：开始从该备份恢复

### 4.3 密码输入界面（加密备份）

#### 界面布局

```
┌─────────────────────────────────────┐
│  < 输入密码                          │  导航栏
├─────────────────────────────────────┤
│                                     │
│  [锁定图标 🔒]                      │  图标
│                                     │
│  此备份已加密，请输入密码以继续      │  提示文字
│                                     │
│  密码提示：我的生日是1988年5月20日   │  密码提示（如果有）
│                                     │
│  ┌───────────────────────────────┐  │
│  │  ••••••••••                    │  │  密码输入框
│  └───────────────────────────────┘  │
│                                     │
│  忘记密码？                          │
│  ┌───────────────────────────────┐  │
│  │  [查看密码提示]                │  │  查看提示按钮
│  └───────────────────────────────┘  │
│                                     │
│  ┌───────────────────────────────┐  │
│  │        确认                    │  │  确认按钮
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

#### 功能说明

**密码输入**：
- 密码输入框（隐藏字符）
- 密码提示显示（如果有设置）
- 忘记密码：可以查看密码提示

**验证**：
- 点击确认后验证密码
- 密码错误：显示错误提示，允许重新输入
- 密码正确：进入恢复选项界面

### 4.4 恢复选项界面

#### 界面布局

```
┌─────────────────────────────────────┐
│  < 恢复选项                          │  导航栏
├─────────────────────────────────────┤
│  恢复模式                            │
│                                     │
│  ○ 不覆盖已存在的消息                │  选项
│     • 只恢复备份中有但当前没有的    │  （默认）
│     • 已存在的消息不会被覆盖        │
│                                     │
│  ● 覆盖已存在的消息                  │  选项
│     • 完全按照备份内容恢复          │
│     • 已存在的消息会被覆盖          │
│                                     │
├─────────────────────────────────────┤
│  媒体文件恢复                        │
│                                     │
│  ● 恢复媒体文件                      │  选项（默认）
│     • 图片、视频、文件都会恢复      │
│     • 保存位置：系统相册/文件        │
│     ┌─────────────────────────────┐  │
│     │  /var/mobile/.../ChatBackups │  │  路径选择
│     └─────────────────────────────┘  │
│                                     │
│  ○ 不恢复媒体文件                    │  选项
│     • 只恢复消息内容                │
│     • 消息中的图片等将显示为占位符  │
│                                     │
├─────────────────────────────────────┤
│  预览恢复内容                        │
│  • 将恢复 3 个会话                   │  预览信息
│  • 将新增 1,234 条消息               │
│  • 将覆盖 234 条消息                 │
│  • 将恢复 56 个媒体文件              │
│                                     │
│  ┌───────────────────────────────┐  │
│  │        开始恢复                │  │  开始恢复按钮
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

#### 功能说明

**恢复模式**：
- 不覆盖已存在的消息：只添加新消息
- 覆盖已存在的消息：按备份完整恢复

**媒体文件恢复**：
- 恢复媒体文件：恢复所有媒体到指定路径
  - 路径选择：点击可选择保存位置
- 不恢复媒体文件：只恢复消息，媒体显示为占位符

**预览信息**：
- 将恢复的会话数
- 将新增的消息数
- 将覆盖的消息数
- 将恢复的媒体文件数

**开始恢复**：
- 点击后开始恢复操作
- 显示恢复进度

### 4.5 恢复进度界面

#### 界面布局

```
┌─────────────────────────────────────┐
│  < 正在恢复                          │  导航栏
├─────────────────────────────────────┤
│                                     │
│         [恢复图标动画]              │  动画图标
│                                     │
│  正在恢复聊天记录...                │  状态文字
│                                     │
│  ┌───────────────────────────────┐  │
│  │ ████████████░░░░░░░░░░░░░░░  │  │  进度条
│  │ 67%                            │  │
│  └───────────────────────────────┘  │
│                                     │
│  已恢复：827 / 1,234 条消息          │  详细信息
│  当前会话：产品讨论群                │
│  已恢复媒体：45 / 56 个              │
│  已用时间：00:15                     │
│  剩余时间：约 00:08                  │
│                                     │
│  ┌───────────────────────────────┐  │
│  │        取消恢复                │  │  取消按钮
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

#### 功能说明

**进度显示**：
- 进度条：显示恢复进度百分比
- 统计信息：已恢复消息数/总消息数
- 当前状态：正在恢复的会话名称
- 媒体恢复：已恢复媒体数/总媒体数
- 时间估算：已用时间、剩余时间

**操作**：
- 取消按钮：取消当前恢复操作
- 取消后确认：弹出确认对话框
  - 注意：已经恢复的数据不会回滚

### 4.6 恢复完成界面

#### 界面布局

```
┌─────────────────────────────────────┐
│  < 恢复完成                          │  导航栏
├─────────────────────────────────────┤
│                                     │
│        [成功图标 ✓]                 │  成功图标
│                                     │
│  恢复已成功完成！                    │  成功提示
│                                     │
│  恢复结果：                          │
│  • 恢复会话：3 个                    │  恢复信息
│  • 新增消息：1,000 条                │
│  • 覆盖消息：234 条                  │
│  • 恢复媒体：56 个                   │
│  • 用时：00:23                       │
│                                     │
│  ┌───────────────────────────────┐  │
│  │        查看聊天记录            │  │  查看按钮
│  └───────────────────────────────┘  │  跳转到聊天列表
│                                     │
│  ┌───────────────────────────────┐  │
│  │        完成                    │  │  完成按钮
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

#### 功能说明

**恢复结果**：
- 恢复的会话数
- 新增的消息数
- 覆盖的消息数
- 恢复的媒体数
- 所用时间

**操作选项**：
- 查看聊天记录：跳转到聊天列表查看恢复的消息
- 完成：返回主界面

---

## 5. 对话框设计

### 5.1 取消确认对话框

```
┌─────────────────────────────────────┐
│                                     │
│         [警告图标 ⚠️]               │
│                                     │
│  确定要取消备份吗？                  │  标题
│                                     │
│  当前进度已完成 45%，取消后进度将丢失 │  说明
│                                     │
│  ┌──────────┐  ┌──────────┐         │
│  │  继续备份  │  │  确认取消 │         │  按钮
│  └──────────┘  └──────────┘         │
│                                     │
└─────────────────────────────────────┘
```

### 5.2 删除备份确认对话框

```
┌─────────────────────────────────────┐
│                                     │
│         [警告图标 ⚠️]               │
│                                     │
│  确定要删除此备份吗？                │  标题
│                                     │
│  聊天备份_2025-01-09                 │  备份信息
│  • 3 个会话 • 1,234 条消息           │
│                                     │
│  删除后无法恢复                      │  警告
│                                     │
│  ┌──────────┐  ┌──────────┐         │
│  │   取消    │  │   确认删除 │        │  按钮
│  └──────────┘  └──────────┘         │
│                                     │
└─────────────────────────────────────┘
```

### 5.3 密码错误提示

```
┌─────────────────────────────────────┐
│                                     │
│         [错误图标 ❌]               │
│                                     │
│  密码错误，请重试                    │  标题
│                                     │
│  您还有 4 次尝试机会                │  剩余次数
│                                     │
│  ┌───────────────────────────────┐  │
│  │        重试                    │  │  重试按钮
│  └───────────────────────────────┘  │
│                                     │
│  忘记密码？                          │
│  [查看密码提示]                      │  查看提示链接
│                                     │
└─────────────────────────────────────┘
```

### 5.4 恢复前确认对话框

```
┌─────────────────────────────────────┐
│                                     │
│         [确认图标 ✓]               │
│                                     │
│  确认要恢复此备份吗？                │  标题
│                                     │
│  聊天备份_2025-01-09                 │  备份信息
│  • 恢复 3 个会话                     │
│  • 新增 1,000 条消息                 │
│  • 覆盖 234 条消息                   │
│                                     │
│  覆盖的消息将无法恢复                │  警告
│                                     │
│  ┌──────────┐  ┌──────────┐         │
│  │   取消    │  │   确认恢复 │        │  按钮
│  └──────────┘  └──────────┘         │
│                                     │
└─────────────────────────────────────┘
```

---

## 6. 空状态设计

### 6.1 无备份文件

```
┌─────────────────────────────────────┐
│  < 从备份恢复                        │  导航栏
├─────────────────────────────────────┤
│                                     │
│         [空文件夹图标 📂]           │
│                                     │
│  暂无备份文件                        │  提示文字
│                                     │
│  创建备份后，您可以在这里查看和恢复  │  说明
│                                     │
│  ┌───────────────────────────────┐  │
│  │   [+ 导入备份文件]             │  │  导入按钮
│  └───────────────────────────────┘  │
│                                     │
│  ┌───────────────────────────────┐  │
│  │        创建备份                │  │  创建备份按钮
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

### 6.2 无会话可选

```
┌─────────────────────────────────────┐
│  < 备份聊天记录                      │  导航栏
├─────────────────────────────────────┤
│                                     │
│         [空状态图标 💬]             │
│                                     │
│  暂无会话可备份                      │  提示文字
│                                     │
│  您还没有任何聊天记录                │  说明
│                                     │
│  ┌───────────────────────────────┐  │
│  │        开始聊天                │  │  引导按钮
│  └───────────────────────────────┘  │
│                                     │
└─────────────────────────────────────┘
```

---

## 7. Toast 提示

### 7.1 成功提示

```
┌─────────────────────────────────────┐
│  ✓  备份已保存到相册                 │  2秒后自动消失
└─────────────────────────────────────┘
```

```
┌─────────────────────────────────────┐
│  ✓  备份文件已分享                  │  2秒后自动消失
└─────────────────────────────────────┘
```

### 7.2 错误提示

```
┌─────────────────────────────────────┐
│  ✕  磁盘空间不足，请清理后重试       │  3秒后自动消失
└─────────────────────────────────────┘
```

```
┌─────────────────────────────────────┐
│  ✕  备份文件已损坏                  │  3秒后自动消失
└─────────────────────────────────────┘
```

---

## 8. 视觉设计规范

### 8.1 颜色方案

```objc
// 主色调
#define PRIMARY_COLOR @"#007AFF"        // 蓝色
#define SUCCESS_COLOR @"#34C759"        // 绿色
#define WARNING_COLOR @"#FF9500"        // 橙色
#define ERROR_COLOR @"#FF3B30"          // 红色

// 背景色
#define BACKGROUND_COLOR @"#F2F2F7"     // 浅灰色
#define CARD_BACKGROUND_COLOR @"#FFFFFF" // 白色

// 文字颜色
#define TITLE_COLOR @"#000000"          // 黑色
#define SUBTITLE_COLOR @"#8E8E93"       // 灰色
#define DESCRIPTION_COLOR @"#636366"    // 深灰色
```

### 8.2 字体规范

```objc
// 标题字体
#define TITLE_FONT [UIFont boldSystemFontOfSize:20]

// 副标题字体
#define SUBTITLE_FONT [UIFont systemFontOfSize:16]

// 正文字体
#define BODY_FONT [UIFont systemFontOfSize:14]

// 说明文字体
#define DESCRIPTION_FONT [UIFont systemFontOfSize:12]
```

### 8.3 间距规范

```objc
// 标准间距
#define STANDARD_MARGIN 16.0

// 卡片内边距
#define CARD_PADDING 12.0

// 元素间距
#define ELEMENT_SPACING 8.0

// 按钮高度
#define BUTTON_HEIGHT 44.0
```

---

## 9. 交互规范

### 9.1 点击反馈

- 所有可点击元素：按下时稍微缩小（0.95倍）
- 按钮点击：有触觉反馈（Impact Feedback）

### 9.2 加载状态

- 网络请求：显示菊花加载动画
- 处理中操作：按钮显示加载状态，禁用点击

### 9.3 错误处理

- 输入错误：实时提示，不允许继续
- 网络错误：显示错误提示，提供重试按钮
- 系统错误：显示友好的错误信息

---

## 10. 辅助功能

### 10.1 VoiceOver 支持

所有元素都需要支持 VoiceOver：

```objc
// 示例
cell.accessibilityLabel = @"张三, 单聊, 最后消息：你好吗";
cell.accessibilityHint = @"双击选择此会话进行备份";
cell.isAccessibilityElement = YES;
```

### 10.2 动态字体支持

支持系统字体大小调整：

```objc
label.font = [UIFont preferredFontForTextStyle:UIFontTextStyleBody];
```

### 10.3 深色模式

支持深色模式，自动适配系统外观：

```objc
// 使用系统颜色
self.view.backgroundColor = [UIColor systemBackgroundColor];
self.textLabel.textColor = [UIColor labelColor];
```

---

## 11. 实现建议

### 11.1 ViewController 结构

```
WFCSettingsViewController              // 设置主界面
  └─ WFCBackupAndRestoreViewController   // 备份与恢复主界面
       ├─ WFCBackupViewController       // 备份界面
       │    ├─ WFCConversationSelectViewController  // 会话选择
       │    ├─ WFCBackupOptionsViewController       // 备份选项
       │    └─ WFCBackupProgressViewController      // 备份进度
       │
       └─ WFCRestoreViewController      // 恢复界面
            ├─ WFCBackupListViewController         // 备份列表
            ├─ WFCBackupDetailViewController       // 备份详情
            ├─ WFCPasswordInputViewController       // 密码输入
            ├─ WFCRestoreOptionsViewController      // 恢复选项
            └─ WFCRestoreProgressViewController     // 恢复进度
```

### 11.2 数据持久化

备份元数据保存在本地数据库或文件：

```objc
// 备份元数据结构
@interface WFCBackupMetadata : NSObject
@property (nonatomic, strong) NSString *backupId;        // 备份唯一ID
@property (nonatomic, strong) NSString *backupName;      // 备份名称
@property (nonatomic, strong) NSString *filePath;        // 文件路径
@property (nonatomic, assign) NSTimeInterval backupTime; // 备份时间
@property (nonatomic, assign) BOOL isEncrypted;         // 是否加密
@property (nonatomic, assign) NSInteger conversationCount; // 会话数
@property (nonatomic, assign) NSInteger messageCount;   // 消息数
@property (nonatomic, assign) long long fileSize;       // 文件大小
@property (nonatomic, strong) NSArray *conversationList; // 会话列表
@end
```

### 11.3 备份文件管理

**自动管理**：
- 备份完成后自动记录元数据
- 应用启动时扫描备份目录
- 删除文件时同步删除元数据

**备份存储路径**：
```
/var/mobile/Containers/Data/Application/[UUID]/Documents/Backups/
```

---

## 12. 测试场景

### 12.1 功能测试

| 场景 | 测试点 | 预期结果 |
|------|--------|---------|
| 备份少量会话 | 选择1-3个会话备份 | 成功创建备份 |
| 备份大量会话 | 选择100+会话备份 | 成功创建备份，进度正常 |
| 备份加密 | 设置密码并备份 | 备份文件加密，需要密码才能恢复 |
| 恢复未加密备份 | 选择未加密备份恢复 | 直接恢复，无需密码 |
| 恢复加密备份 | 输入正确/错误密码 | 正确密码可恢复，错误密码提示错误 |
| 不覆盖恢复 | 选择不覆盖模式 | 只添加新消息 |
| 覆盖恢复 | 选择覆盖模式 | 完全按备份恢复 |
| 取消备份 | 备份过程中取消 | 进度丢失，返回主界面 |
| 删除备份 | 删除备份文件 | 文件和元数据都被删除 |
| 导入备份 | 导入外部备份文件 | 成功导入，显示在列表中 |

### 12.2 边界测试

| 场景 | 测试点 | 预期结果 |
|------|--------|---------|
| 无会话 | 没有任何会话时点击备份 | 显示空状态提示 |
| 无备份 | 没有备份文件时点击恢复 | 显示空状态提示 |
| 磁盘空间不足 | 备份时磁盘不足 | 提示空间不足，无法备份 |
| 密码错误多次 | 连续输入错误密码 | 限制尝试次数，锁定一段时间 |
| 大文件备份 | 备份大文件（1GB+） | 进度正常，内存稳定 |
| 中断恢复 | 恢复过程中应用被杀 | 重新打开时数据一致 |

### 12.3 性能测试

| 场景 | 指标 | 目标 |
|------|------|------|
| 会话列表加载 | 加载时间 | < 0.5秒 |
| 备份列表加载 | 加载时间 | < 0.5秒 |
| 备份进度更新 | 更新频率 | 至少每0.5秒更新一次 |
| 恢复进度更新 | 更新频率 | 至少每0.5秒更新一次 |
| 界面响应 | 点击响应 | < 0.1秒 |

---

## 13. 后续扩展

### 13.1 自动备份

- 定时自动备份
- WiFi下自动备份到云端
- 后台静默备份

### 13.2 备份管理

- 备份文件自动清理
- 保留最近N个备份
- 备份过期提醒

### 13.3 云同步

- iCloud 自动同步
- 跨设备恢复
- 备份版本管理

---

## 14. 总结

本UI设计文档提供了完整的备份恢复功能界面设计，包括：

✅ **导航路径**：从设置到备份恢复的完整路径
✅ **界面设计**：所有界面的详细布局和功能
✅ **交互流程**：备份和恢复的完整操作流程
✅ **对话框**：各种确认和提示对话框
✅ **空状态**：无数据时的友好提示
✅ **视觉规范**：颜色、字体、间距规范
✅ **交互规范**：点击反馈、加载状态等
✅ **辅助功能**：VoiceOver、动态字体、深色模式
✅ **测试场景**：功能和边界测试用例

建议按照本文档实现UI，确保用户体验的一致性和友好性。
